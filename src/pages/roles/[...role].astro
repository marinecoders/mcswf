---
import Layout from '../../layouts/Layout.astro'
import Hero from '../../components/elements/Hero.svelte'

import '../../styles/global.css'
import FooterFull from '../../components/footer/FooterFull.svelte'
import CohortGroup from '../../components/cards/CohortGroup.svelte'
import { getCollection } from 'astro:content'

export async function getStaticPaths() {
  const posts = await Astro.glob('../../content/roles/*.md')
  return posts.map(({ frontmatter, compiledContent }) => {
    return {
      params: { role: frontmatter.url, image_url: frontmatter.image },
      props: { frontmatter, compiledContent },
    }
  })
}
const { frontmatter, compiledContent } = Astro.props
const content = compiledContent()
const entries = await getCollection('cohorts')
---

<Layout title={frontmatter.role}>
  <div
    class="absolute left-0 z-10 flex justify-center w-full align-middle top-24 h-5/6"
  >
    <img src="/ega.svg" />
  </div>
  <div
    class="max-h-screen overflow-y-scroll font-expressway red-radial-gradient scrollbar-hide"
  >
    <div
      class="relative z-20 h-fit pt-20 pb-20 lg:pt-20 bg-cover bg-no-repeat"
      style={{
        backgroundImage: `url('/images/${frontmatter.image_wide}')`,
      }}
    >
      <Hero
        padding="md:pt-24"
        title={frontmatter.role}
        link="#"
        linkText="APPLY NOW"
        titleClasses="text-white"
        contentClasses=""
      />
    </div>
    <div
      class="relative z-20 flex h-fill py-24 place-content-center px-2"
    >
      <article set:html={content} class="prose prose-invert marker:text-white max-w-none w-3/4 prose-hr:opacity-0" />
    </div>
    <div
      class="relative z-20 max-h-screen scrollbar-hide"
    >
      <CohortGroup entries={entries} client:only />
      <div class="">
        <FooterFull client:only background="bg-[#f0f0f0]"/>
      </div>
    </div>
  </div>
</Layout>
